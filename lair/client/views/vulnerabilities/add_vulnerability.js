Template.addVulnerability.events({
    'submit form': function (event, tpl) {
        event.preventDefault();
        var id = Session.get('projectId');
        var title = tpl.find('[name=title]').value;
        var cvss = parseFloat(tpl.find('[name=cvss]').value);
        var description = tpl.find('[name=description]').value;
        var evidence = tpl.find('[name=evidence]').value;
        var solution = tpl.find('[name=solution]').value;
        Meteor.call('addVulnerability', id, title, cvss, description, evidence, solution, function (err, res) {
            if (err) {
                return Alerts.insert({
                    class: 'alert-warning',
                    strong: 'Error',
                    message: err.reason
                });
            }
            return Router.go('/project/' + id + '/vulnerabilities/' + res);
        });
    }
});
